box: node
build:
    steps:
        - npm-install
        - script:
            name: gitbook install
            code: |
                echo "node version $(node -v) running"
                echo "npm version $(npm -v) running"
                npm i gitbook-cli
                node_modules/gitbook-cli/bin/gitbook.js install .
                node_modules/gitbook-cli/bin/gitbook.js build .

                echo 'node_modules/' > .gitignore
                echo 'npm-debug.log' >> .gitignore

deploy:
    steps:
        - install-packages:
            packages: git ssh-client
        - add-ssh-key:
            host: github.com
            keyname: GH_PAGES_DEPLOY_SSHKEY
        - add-to-known_hosts:
            hostname: github.com
            fingerprint: 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48
            type: rsa
        - gsserge/git-push@0.7.19:
            host: github.com
            gh_pages: true
            gh_pages_domain: lowzj.com
            basedir: _book


